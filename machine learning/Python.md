/01. machine learning study- python/

ë³¸ ë‚´ìš©ì€ <ë°‘ë°”ë‹¥ë¶€í„° ì‹œì‘í•˜ëŠ” ë”¥ëŸ¬ë‹>ì„ ì°¸ê³ í•˜ì—¬ ì‘ì„±í•˜ì˜€ìŠµë‹ˆë‹¤.



# Python

## ê°œë°œí™˜ê²½ êµ¬ì¶•

êµ³ì´ ì•„ë‚˜ì½˜ë‹¤ë¥¼ ì„¤ì¹˜í•˜ì§€ ì•Šì•„ë„ ì´ì™• í•˜ëŠ” ê±° ì œëŒ€ë¡œ í•˜ê³  ì‹¶ì–´ì„œ ì•„ë‚˜ì½˜ë‹¤ë¥¼ ì„¤ì¹˜í–ˆë‹¤.

### ì•„ë‚˜ì½˜ë‹¤(Anaconda)

: Python ê¸°ë°˜ì˜ ë°ì´í„° ë¶„ì„ì— í•„ìš”í•œ ì˜¤í”ˆì†ŒìŠ¤ë¥¼ ëª¨ì•„ë†“ì€ ê°œë°œ í”Œë«í¼

  ê°€ìƒí™˜ê²½ ê´€ë¦¬ì, íŒ¨í‚¤ì§€ ê´€ë¦¬ì ì œê³µ



1. ì•„ë‚˜ì½˜ë‹¤ ì„¤ì¹˜

   [ë§í¬] https://www.anaconda.com/products/individual

   â— ê¸°ì¡´ì— íŒŒì´ì¬ì´ ì„¤ì¹˜ë˜ì–´ ìˆë‹¤ë©´ ë°˜ë“œì‹œ ê¸°ì¡´ íŒŒì´ì¬ì„ ì§€ìš´ í›„ ì„¤ì¹˜. (ì¶©ëŒ ì—ëŸ¬ ë°©ì§€)

   â— _Add Anaconda3 to my PATH environment variable_ ê¼­ ì²´í¬

      : cmdì°½ì—ì„œ ì‚¬ìš©í•  ë•Œ í™˜ê²½ë³€ìˆ˜ë¥¼ ì„¤ì •í•˜ëŠ” ë²ˆê±°ë¡œì›€ ë§‰ê¸° ìœ„í•´

   ![image-20210214044158644](C:\Users\yeahaluu\AppData\Roaming\Typora\typora-user-images\image-20210214044158644.png)
   
   
   
2. í…ì„œí”Œë¡œìš° ì„¤ì¹˜

   2-1. ê°€ìƒí™˜ê²½ ìƒì„±

   - í”„ë¡œì íŠ¸ì— í•„ìš”í•œ íŒŒì´ì¬ ë²„ì „ìœ¼ë¡œ ê°€ìƒí™˜ê²½ ë§Œë“¬. 

   - ê°€ìƒí™˜ê²½ ì´ë¦„ì€ ë¬´ì—‡ì´ë“  ìƒê´€ì—†ë‹¤. (ì—¬ê¸°ì„œëŠ” tensorflow)

   ```cmd
   >conda create --name tensorflow python=3.7
   
   >conda create --n tensorflow python=3.7 #ë„ ê°€ëŠ¥
   ```

   2-2. ê°€ìƒí™˜ê²½ í™œì„±í™”(Active)

   ```cmd
   # ì„¤ì¹˜ ëœ ê°€ìƒí™˜ê²½ ë¦¬ìŠ¤íŠ¸ í™•ì¸
   >conda info --envs
   
   # ê°€ìƒí™˜ê²½ í™œì„±í™”
   >activate tensorflow
   
   # ê°€ìƒí™˜ê²½ ë¹„í™œì„±í™” (í…ì„œí”Œë¡œìš° ì„¤ì¹˜í•´ì•¼í•˜ê¸° ë•Œë¬¸ì— ì´ê±´ í•˜ì§€ ì•ŠëŠ”ë‹¤.)
   >deactivate tensorflow
   ```

   2-3. í…ì„œí”Œë¡œìš° ì„¤ì¹˜

   ```cmd
   
   ```
>conda install tensorflow=2.1
   
   ```
   
   ```

   

   â—â— `ModuleNotFoundError: No module named 'matplotlib'` ì´ëŸ° ì—ëŸ¬ê°€ ë‚¬ì„ë•ŒëŠ”?

     ```cmd
   >conda install matplotlib
     
     ```
     
     ```

   

5. íŒŒì´ì°¸ í™˜ê²½ ì„¤ì •

   3-1. íŒŒì´ì°¸ ìƒˆ í”„ë¡œì íŠ¸ë¥¼ ìƒì„±

   3-2. File -> Setting ->project: machine learning -> Python interpreter -> ì˜¤ë¥¸ìª½ ìœ„ í†±ë‹ˆë°”í€´

   3-3. Add -> Conda Environment -> Existing environment -> interpreter ì˜¤ë¥¸ìª½ ... ->ê²½ë¡œì§€ì •

   ê²½ë¡œ: C:\Users\ì•„ì´ë””\Anaconda3\envs\ê°€ìƒí™˜ê²½ì´ë¦„(tensorflow)\pythonw.exe

   ![image-20210214055940157](C:\Users\yeahaluu\AppData\Roaming\Typora\typora-user-images\image-20210214055940157.png)

   

6. ì˜¤ë¥¸ìª½ í•˜ë‹¨ì— ì„¤ì¹˜ê°€ ëë‚˜ë©´,  ì„¤ì¹˜ ì˜ ë˜ì—ˆëŠ”ì§€ í™•ì¸

   ```python
   import tensorflow as tf
   print(tf.__version__)  # 2.1.0
   ```

   

[ì°¸ê³ ] https://it-recording.tistory.com/12

[ì°¸ê³ ] https://niceman.tistory.com/85?category=940952

â“ https://theorydb.github.io/dev/2020/02/14/dev-dl-setting-local-python/ ë‹¤ìŒ ë§í¬ì˜ ê°œë°œí™˜ê²½êµ¬ì¶•í•˜ê¸°ì—ì„œ Nvidiaê°€ ë„ëŒ€ì²´ ë­ê¸¸ë˜ ë””ìŠ¤í”Œë ˆì´ ì–´ëŒ‘í„°ê°€ ì €ê±° ì•„ë‹ˆë©´ ëŒì•„ê°€ë¼ëŠ”ê±°ì§€? 

Q. AMDë‚˜ Intelì—ì„œë„ OpenCL í”„ë ˆì„ì›Œí¬ë¡œ ë”¥ëŸ¬ë‹ì„ í™œìš©í•  ìˆ˜ëŠ” ìˆì§€ë§Œ ì‰½ì§€ ì•Šë‹¤ê³  í•œë‹¤. ë”¥ëŸ¬ë‹í”„ë ˆì„ì›Œí¬(https://www.slideshare.net/JunyiSong1/ss-75552936) ì°¸ê³ í•˜ë¼ê³  í•˜ëŠ”ë° ì•„ë¬´íŠ¼ ì½ì–´ë´ì•¼ê² ìŒ.

## Numpy

1. ë„˜íŒŒì´ ê°€ì ¸ì˜¤ê¸°

   ```python
   import numpy as np
   ```

2. ë„˜íŒŒì´ ë°°ì—´ ìƒì„±í•˜ê¸°

   np.array(): ë¦¬ìŠ¤íŠ¸ë¥¼ ì¸ìˆ˜ë¡œ ë°›ì•„ ë„˜íŒŒì´ ë¼ì´ë¸ŒëŸ¬ë¦¬ê°€ ì œê³µí•˜ëŠ” íŠ¹ìˆ˜í•œ í˜•íƒœì˜ ë°°ì—´(numpy.ndarray) ë°˜í™˜

   ```python
   x = np.array([1.0, 2.0, 3.0])
   print(x)  # [1. 2. 3.]
   type(x)  # <class 'numpy.ndarray'>
   ```

3. ë„˜íŒŒì´ ì‚°ìˆ ì—°ì‚°

   ```python
   x = np.array([1.0, 2.0, 3.0])
   y = np.array([2.0, 4.0, 6.0])
   x + y  # array([3., 6., 9.])  
   x - y  # array([-1., -2., -3.])
   x * y  # array([2., 8., 18.])
   x / y  # array([0.5, 0.5, 0.5])
   ```

   ğŸ’¡ element-wise(ì›ì†Œë³„) ì—°ì‚°: ê°™ì€ í˜•íƒœ(shape)ì˜ ë°°ì—´(ë²¡í„°, í–‰ë ¬)ê°„ì˜ ì—°ì‚°ì€ ê°™ì€ indexì˜ ì›ì†Œë¼ë¦¬ ì—°ì‚°ì„ í•œë‹¤. ë°°ì—´ê°„ì˜ ì—°ì‚°ì‹œ ë°°ì—´ì˜ í˜•íƒœê°€ ê°™ì•„ì•¼í•œë‹¤. (ì›ì†Œìˆ˜ê°€ ë‹¤ë¥´ë©´ ì˜¤ë¥˜ê°€ ë°œìƒ) ë§Œì•½ ë°°ì—´ì˜ í˜•íƒœê°€ ë‹¤ë¥¸ ê²½ìš°, __Broadcast__ ì¡°ê±´ì„ ë§Œì¡±í•˜ë©´ ì—°ì‚°ì´ ê°€ëŠ¥í•˜ë‹¤. (5. ì°¸ê³ )

   

4. ë„˜íŒŒì´ì˜ Nì°¨ì› ë°°ì—´

   ë„˜íŒŒì´ëŠ” 1ì°¨ì› ë°°ì—´ ë¿ ì•„ë‹ˆë¼ ë‹¤ì°¨ì› ë°°ì—´ë„ ì‘ì„±í•  ìˆ˜ ìˆë‹¤.

   ```python
   # 2ì°¨ì› ë°°ì—´(í–‰ë ¬)
   A = np.array([[1, 2], [3, 4]])
   print(A)
   # [[1 2]
   #  [3 4]]
   A.shape  # (2, 2)  Nì°¨ì› ë°°ì—´ì˜ ê° ì°¨ì›ì˜ í¬ê¸°(ì›ì†Œ ìˆ˜): 2x2 í–‰ë ¬
   A.dtype  # dtype('int64')  í–‰ë ¬ì— ë‹´ê¸´ ì›ì†Œì˜ ìë£Œí˜•
   ```

   â“ int__64__ ì—ì„œ 64ëŠ” ë­ë¥¼ ê°€ë¦¬í‚¤ëŠ” ê±°ì§€?

   

   í–‰ë ¬ì˜ ì‚°ìˆ  ì—°ì‚°: ì›ì†Œë³„(element-wise)ë¡œ ê³„ì‚°

   ```python
   B = np.arrapy([[3, 0], [0, 6]])
   A + B
   # array([[ 4,  2],
   #        [ 3, 10]])
   A * B
   # array([[ 3,  0]
   #        [ 0, 24]])
   ```

   ğŸ’¡ 1ì°¨ì› ë°°ì—´: ë²¡í„°(vector), 2ì°¨ì› ë°°ì—´: í–‰ë ¬(matrix), ë²¡í„°ì™€ í–‰ë ¬ì„ ì¼ë°˜í™”í•œ ê²ƒ: (tensor)

   â“ í…ì„œê°€ ë­ì•¼? https://rekt77.tistory.com/102

   

5. __Brodcast__ 

   ë¸Œë¡œë“œìºìŠ¤íŠ¸ ê¸°ëŠ¥ì„ ì´ìš©í•´ ë„˜íŒŒì´ ë°°ì—´ê³¼ ìˆ˜ì¹˜ í•˜ë‚˜(ìŠ¤ì¹¼ë¼ê°’)ì˜ ì¡°í•©ìœ¼ë¡œ ëœ ì‚°ìˆ ì—°ì‚°ë„ ìˆ˜í–‰í•  ìˆ˜ ìˆë‹¤.

   ```python
   # ë²¡í„°ì™€ ìŠ¤ì¹¼ë¼ê°’ì˜ ì‚°ìˆ ì—°ì‚°
   x = np.array([1.0, 2.0, 3.0])
   x / 2.0  # array([0.5, 1., 1.5])
   ```

   ```python
   # í–‰ë ¬ê³¼ ìŠ¤ì¹¼ë¼ê°’ì˜ ì‚°ìˆ ì—°ì‚°
   A = np.array([[1, 2], [3, 4]])
   A * 10
   # array([[ 10, 20],
   #        [ 30, 40]])
   ```

   ì´ëŠ” ìŠ¤ì¹¼ë¼ ê°’ì´ 2x2 í–‰ë ¬ë¡œ í™•ëŒ€ëœ í›„ ì—°ì‚°ì´ ì´ë£¨ì–´ì§€ëŠ” ê²ƒì´ê³  ì´ë¥¼ ë¸Œë¡œë“œìºìŠ¤íŠ¸ ë¼ê³  í•œë‹¤.

   ```python
   A = np.array([[1, 2], [3, 4]])
   B = np.array([10, 20])
   A * B
   # array([[ 10, 40],
   #        [ 30, 80]])
   ```

   ì´ì™€ ê°™ì´ '1ì°¨ì› ë°°ì—´ -> 2ì°¨ì›ë°°ì—´' ë¡œ ë¸Œë¡œë“œìºìŠ¤íŠ¸ë„ ê°€ëŠ¥í•˜ë‹¤.

   

6. ì›ì†Œ ì ‘ê·¼

   ```python
   >>> X = np.array([[51, 55], [14, 19], [9, 4]])
   >>> print(X)
   [[51 55]
    [14 19]
    [ 0  4]]
   >>> X[0]  # 0í–‰
   array([51, 55])
   >>> X[0][1] # (0, 1) ìœ„ì¹˜ì˜ ì›ì†Œ
   ```

   - for ë¬¸ìœ¼ë¡œ ì ‘ê·¼

   ```python
   >>> for row in X:
       	print(row)
   [51 55]
   [14 19]
   [0 4]
   ```

   - ğŸ¤¦â€â™€ï¸ì¸ë±ìŠ¤ë¥¼ ë°°ì—´ë¡œ ì§€ì •í•´ í•œ ë²ˆì— ì—¬ëŸ¬ ì›ì†Œì— ì ‘ê·¼

   ```python
   >>> X = X.flatten()  # 1ì°¨ì› ë°°ì—´ë¡œ í‰íƒ„í™”
   >>> print(X)
   [51 55 14 19  0  4]
   >>> X[np.array(0, 2, 4)]  # ì¸ë±ìŠ¤ê°€ 0, 2, 4ì¸ ì›ì†Œ ì–»ê¸°
   array([51, 14, 0])
   ```

   ì´ ê¸°ë²• ì‚¬ìš©í•´ ì›í•˜ëŠ” ì¡°ê±´ì˜ ì›ì†Œë§Œ ì–»ê¸°

   ```python
   >>> X > 15
   array([ True, True, False, True, False, False], dtype=bool)  #dtype: í–‰ë ¬ì— ë‹´ê¸´ ì›ì†Œì˜ ìë£Œí˜•
   >>> X[X>15]
   array([15, 55, 19])
   ```

   ğŸ’¡ íŒŒì´ì¬(ë™ì  ì–¸ì–´)ì€ Cë‚˜ C++ ê°™ì€ ì •ì  ì–¸ì–´(ì»´íŒŒì¼ ì–¸ì–´) ë³´ë‹¤ ì²˜ë¦¬ì†ë„ê°€ ëŠë¦¬ë‹¤.

   â€‹    -> ë¬´ê±°ìš´ ì‘ì—…í• ë• C/C++ë¡œ ì‘ì„±í•œ í”„ë¡œê·¸ë¨ ì“°ëŠ”í¸ ì¢‹ìŒ.

   â€‹    -> íŒŒì´ì¬ì—ì„œ ë¹ ë¥¸ ì„±ëŠ¥ ìš”êµ¬ë  ë•Œ, í•´ë‹¹ ë¶€ë¶„ì„ C/C++ë¡œ êµ¬í˜„í•œë‹¤. ì´ ë•Œ íŒŒì´ì¬ì€ C/C++ë¡œ ì‘ì„±í•œ í”„ë¡œê·¸ë¨ì„ í˜¸ì¶œí•´ì£¼ëŠ” _ì¤‘ê°œì_ ì—­í• 

   â€‹    -> ë„˜íŒŒì´ë„ ì£¼ëœ ì²˜ë¦¬ëŠ” Cì™€ C++ë¡œ êµ¬í˜„. - ì„±ëŠ¥ì„ í•´ì¹˜ì§€ ì•Šìœ¼ë©° íŒŒì´ì¬ ë¬¸ë²• ì‚¬ìš© ê°€ëŠ¥

   â“ ê·¸ëŸ¬ë©´ Cë‚˜ C++ì„ ì™œ ì¨ì•¼í•¨?

   

   ## matplotlib

   : ê·¸ë˜í”„ë¥¼ ê·¸ë¦¬ê¸° ìœ„í•œ ë¼ì´ë¸ŒëŸ¬ë¦¬. ê·¸ë˜í”„ ê·¸ë¦¬ê¸°ì™€ ë°ì´í„° ì‹œê°í™”ë¥¼ ìœ„í•´ í•„ìš”.

   1. ë‹¨ìˆœí•œ ê·¸ë˜í”„ ê·¸ë¦¬ê¸° (sin í•¨ìˆ˜)

      ```python
      import numpy as np
      import matplotlib.pyplot as plt

      # ë°ì´í„° ì¤€ë¹„
      X = np.arange(0, 6, 0.1)  # 0ì—ì„œ 6ê¹Œì§€ 0.1ê°„ê²©ìœ¼ë¡œ ìƒì„±
      Y = np.sin(X)
      
      # ê·¸ë˜í”„ ê·¸ë¦¬ê¸°
      plt.plot(X, Y)
      plt.show()
      ```
      
      ![image-20210214070309019](Python.assets/image-20210214070309019.png)
      
   2. pyplotì˜ ê¸°ëŠ¥ (cos ê¸°ëŠ¥)

      ```python
      import numpy as np
      import matplotlib.pyplot as plt
      
      # ë°ì´í„° ì¤€ë¹„
      x = np.arange(0, 6, 0.1)  # 0ì—ì„œ 6ê¹Œì§€ 0.1 ê°„ê²©ìœ¼ë¡œ ìƒì„±
      y1 = np.sin(x)
      y2 = np.cos(x)
      
      #ê·¸ë˜í”„ ê·¸ë¦¬ê¸°
      plt.plot(x, y1, label='sin')
      plt.plot(x, y2, linestyle='--', label='cos')  # cos í•¨ìˆ˜ ì ì„ ìœ¼ë¡œ ê·¸ë¦¬ê¸°
      
      plt.xlabel('x')  # xì¶• ì´ë¦„
      plt.ylabel('y')  # yì¶• ì´ë¦„
      
      plt.title('sin & cos')
      
      plt.legend()
      plt.show()
      ```

      ![image-20210214071243029](Python.assets/image-20210214071243029.png)

      â“ plt.legend() ë­ì§€? ì™¼ìª½ ì•„ë˜?

      â“ ì ì„  í‘œì‹œëŠ” --ì¸ê±´ê°€? /Q. ê·¸ë ‡ë„¤/ ë‹¤ë¥¸ê±´ ë­ê°€ ìˆì§€? 

   

   3. ì´ë¯¸ì§€ í‘œì‹œ

      ```python
      import matplotlib.pyplot as plt
      from matplotlib.image import imread
      
      img = imread('ê³ ìŠ´ë„ì¹˜.jpg')
      
      plt.imshow(img)
      plt.show()
      ```

      ![image-20210214071724743](Python.assets/image-20210214071724743.png)

      â“plt.imshowëŠ” showì™€ imgë¥¼ ì—°ê²°í•´ì£¼ë‚˜?

   

   